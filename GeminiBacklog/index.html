<!DOCTYPE html>
<html>
<head>
    <title>Gemini Backlog</title>
    <meta charset="utf-8" />
    <script src="Scripts/jquery-2.2.3.min.js"></script>
    <script src="Scripts/handlebars.min.js"></script>
    <script src="Scripts/jquery-ui-1.11.4.min.js"></script>
    <script src="Scripts/Dashboard.js"></script>
    <link rel="stylesheet" type="text/css" href="Content/jquery-ui.min.css">
    <link rel="stylesheet" type="text/css" href="Content/site.css" />
    <script type="text/javascript">
        $(Dashboard.init);
    </script>
</head>
<body>
    <div class="page-wrap">
        <div id="tabs"></div>
    </div>
    <footer></footer>

    <script id="footer-template" type="text/x-handlebars-template">
        version {{version}}
    </script>
    <script id="tabs-template" type="text/x-handlebars-template">
        <ul>
            <li><a href="#backlog">Dev Priorities</a></li>
            <li><a href="#bau">BAU Tasks</a></li>
            <li><a href="#enhancements">Application Enhancements</a></li>
            <li><a href="#timesheetsTabs">Time Logging</a></li>
            <li><a href="#metrics">Metrics</a></li>
        </ul>
        <div id="backlog"></div>
        <div id="bau"></div>
        <div id="enhancements"></div>
        <div id="timesheetsTabs">
            <ul>
                {{#people}}
                <li data-gemini-user-id="{{geminiId}}"><a href="#workdone">{{name}}</a></li>
                {{/people}}
            </ul>
            <div id="workdone">
                <div id="dates">
                </div>
                <div id="history" />
                <div id="assignedTasks">
                    <h4>Assigned Tasks</h4>
                    <div></div>
                </div>
            </div>
        </div>
        <div id="metrics"></div>
    </script>
    <script id="availabledates-template" type="text/x-handlebars">
        <select id="availableDates">
            {{#availableDates}}
            <option value="{{dateValue}}">{{dateText}}</option>
            {{/availableDates}}
        </select>
    </script>
    <script id="issues-template" type="text/x-handlebars-template">
        <div class="row">
            <div class="column grid_1 strong">Issue</div>
            <div class="column grid_4 strong">Summary</div>
            <div class="column grid_2 strong">Status</div>
            <div class="column grid_1 strong">Type</div>
            <div class="column grid_1 strong">DueDate</div>
            <div class="column grid_1 strong">Created</div>
            <div class="column grid_1 strong">Priority</div>
        </div>
        {{#issues}}
        <div class="row bordered">
            <div class="column grid_1">
                <a target="_blank" href="{{geminiUri}}">{{issue}}</a>
            </div>
            <div class="column grid_4">{{summary}}</div>
            <div class="column grid_2">{{status}}</div>
            <div class="column grid_1">{{type}}</div>
            <div class="column grid_1">{{#if dueDate}} {{formatDate dueDate}} {{else}}&nbsp;{{/if}}</div>
            <div class="column grid_1">{{formatDate created}}</div>
            <div class="column grid_1">{{priority}}</div>
        </div>
        {{/issues}}
    </script>
    <script id="enhancements-template" type="text/x-handlebars-template">
        <div class="row">
            <div class="column grid_1 strong">Issue</div>
            <div class="column grid_4 strong">Summary</div>
            <div class="column grid_2 strong">Assigned To</div>
            <div class="column grid_2 strong">Status</div>
            <div class="column grid_1 strong">DueDate</div>
            <div class="column grid_1 strong">Priority</div>
        </div>
        {{#issues}}
        <div class="row bordered">
            <div class="column grid_1">
                <a target="_blank" href="{{geminiUri}}">{{issue}}</a>
            </div>
            <div class="column grid_4">{{summary}}</div>
            <div class="column grid_2">
                {{#assignedTo}}
                <p>{{.}}</p>
                {{/assignedTo}}
            </div>
            <div class="column grid_2">{{status}}</div>
            <div class="column grid_1">{{#if dueDate}} {{formatDate dueDate}} {{else}}&nbsp;{{/if}}</div>
            <div class="column grid_1">{{priority}}</div>
        </div>
        {{/issues}}
    </script>
    <script id="history-template" type="text/x-handlebars-template">
        {{#dates}}
        <div class="day">
            <h2>{{dayOfWeek}}</h2>
            {{#each issues}}
            <div class="row">
                <div class="column grid_1">{{geminiRef}}</div>
                <div class="column grid_1">{{total.hours}}h {{total.minutes}}m</div>
                <div class="column grid_10">{{issue}}</div>
            </div>
            {{#tasks}}
            <div class="row">
                <div class="column grid_2">&nbsp;</div>
                <div class="column grid_10 italic">&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;{{comments}} [{{total.hours}}h {{total.minutes}}m]</div>
            </div>
            {{/tasks}}
            {{else}}
            <div class="row">
                <div class="column grid_2">&nbsp;</div>
                <div class="column grid_10 italic">No time logged for the day</div>
            </div>
            {{/each}}
            <div class="row">
                <div class="column grid_1 strong">&nbsp;</div>
                <div class="column grid_1 strong">{{total.hours}}h {{total.minutes}}m</div>
            </div>
        </div>
        {{/dates}}
    </script>

    <script id="metrics-template" type="text/x-handlebars">
        <div>
            <h2>Re-Opened Issues</h2>
            <div class="row">
                <div class="column grid_2 strong alignRight">Last 1 Month:</div>
                <div class="column grid_1 alignCenter">
                    {{reopenedIssues.last1Months.count}}
                </div>
                <div class="column grid_9">
                    <a href="#" data-uri="{{reopenedIssues.last1Months.uri}}">show issues</a>
                </div>
            </div>
            <div class="row hidden">
                <div class="column grid_12"></div>
            </div>
            <div class="row">
                <div class="column grid_2 strong alignRight">Last 3 Months:</div>
                <div class="column grid_1 alignCenter">
                    {{reopenedIssues.last3Months.count}}
                </div>
                <div class="column grid_9">
                    <a href="#" data-uri="{{reopenedIssues.last3Months.uri}}">show issues</a>
                </div>
            </div>
            <div class="row">
                <div class="column grid_2 strong alignRight">Last 6 Months:</div>
                <div class="column grid_1 alignCenter">
                    {{reopenedIssues.last6Months.count}}
                </div>
                <div class="column grid_9">
                    <a href="#" data-uri="{{reopenedIssues.last6Months.uri}}">show issues</a>
                </div>
            </div>
        </div>
    </script>
    <script id="reopened-issue-template" type="text/x-handlebars">
        <div class="row">
            <div class="column grid_2 strong">Issue</div>
            <div class="column grid_10 strong">Summary</div>
        </div>
        {{#issues}}
            <div class="row">
                <div class="column grid_2">{{issue}}</div>
                <div class="column grid_10">{{summary}}</div>
            </div>
        {{/issues}}
    </script>
</body>
</html>
